\section{Speech Experiments}
\label{section:speech}

We perform experiments to study a compositional approach of integrating speech capabilities into Llama 3, resembling the method we used for visual recognition. On the input side, an encoder, together with an adapter, is incorporated to process speech signals. We leverage a system prompt (in text) to enable different modes of operation for speech understanding in Llama 3.
If no system prompt is provided, the model acts as a general-purpose spoken dialogue model which can effectively respond to the user speech in a manner that is consistent with the text-only version of Llama 3.
The dialogue history is introduced as the prompt prefix to improve the multi-round dialogue experience.
We also experiment with system prompts that enable the use of Llama 3 for automatic speech recognition (ASR) and automatic speech translation (AST).
The speech interface of Llama 3 supports up to 34 languages.\footnote{The speech interface supports the following 34 languages:
	Arabic,
	Bengali,
	Chinese,
	Czech,
	Dutch,
	English,
	Finnish,
	French,
	German,
	Greek,
	Gujarati,
	Hindi,
	Hungarian,
	Indonesian,
	Italian,
	Japanese,
	Kannada,
	Korean,
	Malayalam,
	Marathi,
	Persian,
	Polish,
	Portuguese,
	Romanian,
	Russian,
	Spanish,
	Swahili,
	Swedish,
	Tamil,
	Telugu,
	Thai,
	Turkish,
	Urdu,
	Vietnamese.}
It also allows for the interleaved input of text and speech, enabling the model to solve advanced audio-comprehension tasks.

We also experiment with a speech generation approach in which we implement a streaming text-to-speech (TTS) system that generates speech waveforms on-the-fly during language model decoding. We design the speech generator for Llama 3 based on a proprietary TTS system and do not fine-tune the language model for speech generation. Instead, we focus on improving speech synthesis latency, accuracy, and naturalness by leveraging Llama 3 embeddings at inference time.
The speech interface is illustrated in Figure~\ref{sph:fig:multimodal_model_overview} and~\ref{sph:fig:model}.

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{assets/llama-speech-6x.png}
    \caption{\textbf{Architecture of our speech interface for Llama 3.}}
    \label{sph:fig:model}
\end{figure}

\input{speech/data.tex}
\input{speech/model_architecture.tex}
\input{speech/training_recipe.tex}
\input{results/speech.tex}
